<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Complete Example</title>
<link rel="stylesheet" href="https://cdn.pydata.org/bokeh/release/bokeh-0.13.0.min.css" type="text/css" />
<link rel="stylesheet" href="https://cdn.pydata.org/bokeh/release/bokeh-widgets-0.13.0.min.css" type="text/css" />
<link rel="stylesheet" href="https://cdn.pydata.org/bokeh/release/bokeh-tables-0.13.0.min.css" type="text/css" />
<script type="text/javascript" src="https://cdn.pydata.org/bokeh/release/bokeh-0.13.0.min.js"></script>
<script type="text/javascript" src="https://cdn.pydata.org/bokeh/release/bokeh-widgets-0.13.0.min.js"></script>
<script type="text/javascript" src="https://cdn.pydata.org/bokeh/release/bokeh-tables-0.13.0.min.js"></script>
<script type="text/javascript" src="https://cdn.pydata.org/bokeh/release/bokeh-api-0.13.0.min.js"></script>
<script src="https://d3js.org/d3.v5.min.js"></script>
</head>

<body>

<button onclick="addPoint()">Add some data!</button><br/>

<div>
<script type="text/javascript">
	
var source = new Bokeh.ColumnDataSource({
	data: { date: [], days_before: [], days_since: [] }
});

var columns = [
	new Bokeh.Tables.TableColumn({ field: "date", title: "date" }), //formatter: Bokeh.Tables.DateFormatter()}),
	new Bokeh.Tables.TableColumn({ field: "days_before", title: "days_before" }),
	new Bokeh.Tables.TableColumn({ field: "days_since", title: "days_since" })
]    
    
// make the plot and add some tools
//var tools = "pan,crosshair,wheel_zoom,box_zoom,reset,save";

//var plot = Bokeh.Plotting.figure({title:'Example of Random data', tools: tools, height: 300, width: 300});
var data_table = new Bokeh.Tables.DataTable({ source: source, columns: columns }); 
	
var select = new Bokeh.Widgets.DatePicker({ title: "Date:", value: Date.now() }); 

// Show the plot, appending it to the end of the current
// section of the document we are in.
// Bokeh.Plotting.show(plot,document.currentScript.parentElement);    
Bokeh.Plotting.show(data_table, document.currentScript.parentElement);
Bokeh.Plotting.show(select, document.currentScript.parentElement);

function addPoint() {
	d3.csv("fomc_calendar.csv", function(csv) { 
		return { 
			date: new Date(csv.date), 
			days_before: +csv.days_before,
			days_since: +csv.days_since  
		};
	}).then(function(data) {
		//console.log(data);
        fomc_calendar = data;
        
        source.data.date = fomc_calendar.map(function(row,i) { return row.date; });
        source.data.days_before = fomc_calendar.map(function(row,i) { return row.days_before; });
        source.data.days_since = fomc_calendar.map(function(row,i) { return row.days_since; });
        source.change.emit();
	});	
}

</script>
</div>
</body>
</html>